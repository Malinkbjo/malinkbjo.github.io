<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Title</title>
</head>
<body>

    <canvas id="bCanvas" width="600" height="400"></canvas>
    <canvas id="fCanvas" width="600" height="400"></canvas>



    <script>
        // Referanser til HTML-element
        var bCanvas = document.getElementById("bCanvas");
        var ctx = bCanvas.getContext("2d");

            // Globale variabler
        var levende = true;
        var frame = 0;


        var bane = {
            bredde:bCanvas.width,
            hoyde: bCanvas.height,
            bakgrunnsfarge: "grey",
        };
        var figur1 = {
            bredde: 30,
            hoyde: 30,
            farge: "orange",
            xpos: 100,
            ypos: 350,
            xfart: 1,
            yfart: 2,
            xretning:0,
            yretning:-5,
        };
        var hinder = {
            bredde: 20,
            hoyde: 20,
            farge: "yellow",
            xpos: 500,
            ypos: 360,
            xfart: 5,
            yfart: 5,
            xretning:1,
            yretning:1

        };
        var hinder2 = {
            bredde: 20,
            hoyde: 20,
            farge: "yellow",
            xpos: 700,
            ypos: 360,
            xfart: 5,
            yfart: 5,
            xretning:1,
            yretning:1

        };
        var hinderEgenskaper = {
           bredde: 20,
           hoyde: 20,
           farge: "yellow",
           ypos: 360,
           xfart: 5,
           yfart: 5,
           xretning: 1,
           yretning: 1,
        };



        //Hendelsesfunksjon
        window.onkeydown = hoppFigur;


        // funksjonsdefinisjoner
       function gameLoop() {
           frame += 1;
           tegnBane();
           genererHindere(hinderEgenskaper);
           tegnHindere(hindere);
           flyttHindere(hindere);
           tegnFigur(figur1);
           flyttHinder(hinder);
           flyttHinder(hinder2);
           flyttHinder(hindere);
           tegnHinder(hinder);
           tegnHinder(hinder2);
           gravitasjon(figur1);
           sjekkKollisjon();
           if(levende){
               requestAnimationFrame(gameLoop);
           }
       }

        function tegnBane() {
            ctx.fillStyle = bane.bakgrunnsfarge;
            //ctx.drawImage()
            ctx.fillRect(0, 0, bane.bredde, bane.hoyde)
        }

        function tegnFigur(figur) {
            ctx.fillStyle = figur.farge;
            ctx.fillRect(figur.xpos, figur.ypos, figur.bredde, figur.hoyde)
        }

        function hoppFigur(event){
            if(event.code === "Space"){
                figur1.ypos -= 50;
            }

        }
        function gravitasjon() {

            if (figur1.ypos < bCanvas.height- 5,0){
                figur1.ypos +=figur1.yfart;
            }
        }
        function flyttHinder(hinder) {
            hinder.xpos -= (hinder.xretning*hinder.xfart)
        }

        function tegnHinder(hinder) {
            ctx.fillStyle = hinder.farge;
            ctx.fillRect(hinder.xpos, hinder.ypos, hinder.bredde, hinder.hoyde)

        }


        function tegnHindere(hindere) {
            for(let hinder of hindere){
                tegnHinder(hinder);
            }
        }

        function flyttHindere(hindere) {
            for (let hinder of hindere){
                flyttHinder(hinder);
            }
        }

        function sjekkKollisjon() {

        }

        let hindere = [];

        function genererHindere(hinderEgenskaper) {
            if(frame % 60 == 0){
                let x = Math.random() + 600;
                let nyttHinder = {
                    xpos: x,
                    ypos:hinderEgenskaper.ypos,
                    bredde: hinderEgenskaper.bredde,
                    hoyde: hinderEgenskaper.hoyde,
                    farge: hinderEgenskaper.farge,
                    xretning: hinderEgenskaper.xretning,
                    xfart: hinderEgenskaper.xfart
                };

                hindere.push(nyttHinder);
            }
        }

        // setup/start
       gameLoop();

    </script>

</body>
</html>